# IP

## 在网络传输中, HTTP协议已经说明了源IP，目标服务器IP，为什么还需要说明MAC地址？
- IP并不唯一，目标服务器可能是多台计算机共用一个IP; MAC地址则是唯一的
- IP相当于一个人的居住地址，可以知道一个人的大致所处方位; MAC地址相当于一个人的身份证，可以精确找到目标

## 查看本机的IP地址
- windows: `ipconfig`
- linux: `ifconfig` 或者 `ip addr`

## 基础
- 以下描述的都是IPv4
- IP地址占32个bit
- 组成：网络号 + 主机号  
  网络号：标识主机(或路由器)所连接到的网络，一个网络号在整个因特网上都必须是唯一的  
  主机号：标识该主机（或路由器）主机号在它前面的网络号所指明的网络范围内必须是唯一的
- 分类：
  * A类（占全部IPv4的50%）
    - 可以指派的网络号是126个(即2^7-2)
      * 网络号字段为全0的IP地址是个保留地址，意思是“本网络”。
      * 网络号为127(即01111111)保留作为本地软件环回测试(loopback test)
    - 主机号2^24-2
      * 全0的主机号字段表示该IP地址是“本主机”所连接到的单个网络地址(例如，一主机的IP地址为`5.6.7.8`，则该主机所在的网络地址就是`5.0.0.0`)
      * 全1的主机号字段表示该IP地址是“所有的”，即该网络上的所有主机
  * B类（占全部IPv4的25%）
    - 可指派的网络数是2^14-1
      * B类网络地址128.0.0.0是不指派的，所以指派的B类最小网络地址是128.1.0.0
    - 最大主机数是2^16-2
      * 这里需要减2是因为要扣除全0和全1的主机号
  * C类（占全部IPv4的12.5%）
    - 可指派的网络数是2^21-1
      * C类网络地址192.0.0.0是不指派的，而可以指派的C类最小网络地址是192.0.1.0
    - 最大主机数是2^8-2
      * 这里需要减2是因为要扣除全0和全1的主机号
  * D类
    - 它是一个专门保留的地址。它并不指向特定的网络，目前这一类地址被用在多点广播（Multicast）中。
    - 多点广播地址用来一次寻址一组计算机，它标识共享同一协议的一组计算机
    - 使用这一类地址，属于某个组的机器都能收到。这有点类似 在公司里面大家都加入了一个邮件组。发送邮件，加入这个组的都能收到。
    - 用于`VXLAN`协议
  * E类
    - 保留
    - 全零（“0．0．0．0”）地址对应于当前主机。全“1”的IP地址（“255．255．255．255”）是当前子网的广播地址


  ![ip分类](../assets/ip分类.png)  
  ![ip主机](../assets/ip主机.png)  

## CIDR - 无类型域间选路 - 一种ip地址的表示方式
- 例子：`10.100.122.2/24`, 这里的`/24`表示前24位是网络号,后8位是主机号
- 改变了上述的ip分类方式,将32位的ip地址分为两部分：网络号+主机号


## 例题
### 广播地址
- 广播地址(Broadcast Address)是专门用于同时向网络中所有工作站进行发送的一个地址。
- 在使用TCP/IP 协议的网络中，`主机号为全1` 的IP地址为广播地址，广播的分组传送给host ID段所涉及的所有计算机。
- 例如，对于10.1.1.0 （255.255.255.0 ）网段，其广播地址为10.1.1.255 （255 即为2 进制的11111111 ），当发出一个目的地址为10.1.1.255 的分组（封包）时，它将被分发给该网段上的所有计算机。
### 子网掩码
与ip地址搭配，32位，其中`1`表示网络号，`0`表示主机号，用于表示一个地址中哪一部分是主机号，哪一部分是网络号
### 题目
- 计算`16.158.165.91/22` 这个 CIDR 的第一个地址、子网掩码和广播地址  
- 

## 参考
- [IP分类：A,B,C,D,E五类](https://www.cnblogs.com/weiyouqing/p/8940623.html)